---
import Layout from '../layouts/Layout.astro';
import Card from '../components/molecules/Card.astro';
import ProjectCard from '../components/molecules/ProjectCard.astro';
import SocialLinks from '../components/molecules/SocialLinks.astro';
import Button from '../components/atoms/Button.astro';
import Heading from '../components/atoms/Heading.astro';
import Text from '../components/atoms/Text.astro';
import Icon from '../components/atoms/Icon.astro';
import { getFeaturedProjects } from '../utils/projects';
import RemoteImage, {profileImage} from '../components/atoms/RemoteImage.astro';
import BlogPostCard from '../components/molecules/BlogPostCard.astro';
import { getCollection } from 'astro:content';

// Obtener proyectos destacados desde Content Collections
const featuredProjects = await getFeaturedProjects();

// Obtener los √∫ltimos 3 posts desde Content Collections m√°s recientes
const latestPosts = (await getCollection("posts")).sort((a: any, b: any) => 
	b.data.pubDate.getTime() - a.data.pubDate.getTime()
).slice(0, 3);

---

<Layout title="Inicio | Carlos Mairena" currentPath="/">
	<!-- Hero Section -->
	<main class="bg-gradient-to-br from-blue-50 to-purple-50 py-20">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="text-center">
				<!-- Foto profesional -->
				<div class="mb-8">
					<div class="w-36 h-36 mx-auto rounded-full bg-gradient-to-r from-blue-500 to-purple-600 p-1">
							<!-- Foto profesional -->
							<RemoteImage src={profileImage} 
								alt="Carlos Mairena L√≥pez"
								class="w-full h-full rounded-full bg-gray-200 flex items-center justify-center object-cover"
								loading="eager"
							/>
					</div>
				</div>
				
				<Heading level={1} class="text-center leading-tight mb-4">
					Est√°s en <span class="bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">carlosmmairena.com</span> üëãüèΩ
				</Heading>
				
				<Text color="secondary" size="xl" class="text-center mb-5 max-w-3xl mx-auto">
					Compartimos ideas y conocimientos sobre infraestructura de servidores, redes, ciberseguridad y m√°s.
				</Text>
				<Text color="secondary" size="xl" class="text-center mb-8 max-w-3xl mx-auto">
					M√°s all√° del c√≥digo, unidos hacemos m√°s.
				</Text>
				
				<!-- CTAs -->
				<div class="flex flex-col sm:flex-row gap-4 justify-center mb-8">
					<Button variant="primary" size="lg" href="/proyectos">
						<Icon name="arrow-right" size="sm" class="mr-2" />
						Proyectos
					</Button>
					<Button variant="outline" size="lg" href="/sobre-mi" >
						<Icon name="external-link" size="sm" class="mr-2" />
						Sobre m√≠
					</Button>
				</div>

				<div class="flex justify-center mb-8">
					<Button variant="secondary" size="lg" href="/contacto">
						<Icon name="external-link" size="sm" class="mr-2" />
						Necesito una asesor√≠a
					</Button>
				</div>
				
				<!-- Redes sociales -->
				<SocialLinks size="lg" class="justify-center" />
			</div>
		</div>
	</main>
	
	<!-- Services Section -->
	<section class="py-16 bg-white">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="text-center mb-12">
				<Heading level={2} size="3xl" class="mb-4">
					¬øDe qu√© puedes hablar conmigo?
				</Heading>
				<Text color="secondary" size="lg" class="max-w-2xl mx-auto">
					Podemos conversar sobre conocimientos y experiencias en tecnolog√≠a, por ejemplo sobre los siguientes temas:
				</Text>
			</div>
			
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-5">
				<Card
					title="üíª Desarrollo Full Stack"
					body="Dise√±o y programaci√≥n de aplicaciones web y m√≥viles, desde la idea hasta el despliegue en producci√≥n."
				/>
				<Card
					title="üèóÔ∏è Infraestructura y Ciberseguridad"
					body="Implementaci√≥n de infraestructura on-premise y en la nube, hardening, auditor√≠as de seguridad, entre otros."
				/>
				<Card
					title="üí° Asesor√≠as"
					body="Apoyo principalmente en temas de trabajo en equipo, inteligencia artificial, servidores, redes, despliegue de aplicaciones y ciberseguridad."
				/>
			</div>
		</div>
	</section>
	
	<!-- Featured Projects Section -->
	{featuredProjects.length > 0 && (
		<section class="py-16 bg-white">
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
				<div class="text-center mb-12">
					<Heading level={2} size="3xl" class="mb-4">
						Proyectos
					</Heading>
					<Text color="secondary" size="lg" class="max-w-2xl mx-auto mb-6">
						Proyectos que he desarrollado, espero que estos sean de gran ayuda para ti.
					</Text>
					<Button variant="secondary" href="/proyectos">
						Ver m√°s ‚Üí
					</Button>
				</div>
				
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					{featuredProjects.map(project => (
						<ProjectCard
							title={project.title}
							description={project.description}
							technologies={project.technologies}
							githubUrl={project.githubUrl}
							demoUrl={project.demoUrl}
							projectCategory={project.projectCategory}
							category={project.category as 'primary' | 'warning' | 'danger'}
						/>
					))}
				</div>
			</div>
		</section>
	)}

	<!-- Blog Section -->
	<section class="py-16 bg-gray-50">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="text-center mb-12">
				<Heading level={2} size="3xl" class="mb-4">
					√öltimas publicaciones
				</Heading>
				<Text color="secondary" size="lg" class="max-w-2xl mx-auto mb-6">
					√öltimos datos sobre ideas que espero puedan ser de ayuda para ti, si quieres ver m√°s puede ir a mi blog.
				</Text>
				<Button variant="secondary" href="/blog">
					‚Üí Ir al blog
				</Button>
			</div>

			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
				{latestPosts.map(post => (
					<BlogPostCard
						imageUrl={post.data.image?.url}
						imageAlt={post.data.image?.alt}
						slug={post.id}
						title={post.data.title}
						description={post.data.description}
						pubDate={post.data.pubDate}
						author={post.data.author}
						tags={post.data.tags}
						/>
					))}
			</div>
		</div>
	</section>
</Layout>
